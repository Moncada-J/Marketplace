<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel='stylesheet' href='/stylesheets/style.css' />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
  <title>Produce Details</title>
</head>
<body>
<!-- review will go here -->
    <div class="alert alert-danger" role="alert">
      <h4 class="alert-heading">Wait!</h4>
      <p>Are you sure you want to purchase <i>this</i> produce?
        <br> Please make sure you've reviewed the following details before proceeding.
      </p>
      <hr>
      <p class="mb-0"><strong>Produce Type:</strong>
        <br><%= item.itemType %>
            <div><strong>Produce Name: </strong></div>
            <div><%= item.name%></div>
            <div><strong>Quantity:</strong></div>
            <div><%= item.quantity %></div>
            <div><strong>Price:</strong></div>
            <div><%= item.price%></div></p>
    </div>
    <h3>Update Product Info</h3>
    <form id="new-form" action="/items/<%= item._id %>?_method=PUT" method="POST">
      <label>Quantity:
        <select name="quantity">
                   <option name="min" value="1">1</option>
                   <option  value="2">2</option>
                   <option  value="3">3</option>
                   <option  value="4">4</option>
                   <option name="max" value="5">5</option>
           </select>
     </label><br>
     <label>Listing Price per lb:
         <input type="number" class="custom-price" name="price" placeholder="Listing Price">
       <br>
      <input type="submit" value="Update Product Info" />
    </form>
    <br><br>
    <h3>Reviews</h3>
    <form id="add-review-form" method="POST" action="/items/<%= item._id %>/reviews">
    <label>Review:</label>
    <textarea name="content"></textarea>
    <label>Rating:</label>
    <select name="rating">
      <option value="1">1</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5</option>
    </select>
    <input type="submit" value="Add Review">
    </form> 

    <% if(item.reviews.length) { %>
      <table>
        <thead>
          <tr>
            <th>Date</th>
            <th>Review</th>
            <th>Rating</th>
          </tr>
        </thead>
        <tbody>
          <% item.reviews.forEach(function(r){ %> 
            <tr>
              <td><%= r.createdAt.toLocaleDateString() %></td>
              <td><%= r.content %></td>
              <td><%= r.rating %></td>
            </tr>
            <% }); %> 
        </tbody>
      </table>
        <% } else { %> 
          <h5>No Reviews Yet</h5>
        <% } %> 
</body>
</html>